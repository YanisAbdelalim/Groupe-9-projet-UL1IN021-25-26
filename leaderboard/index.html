<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Classement</title>
    <link rel="stylesheet" href="style_index.css">
</head>
<body>
    <h2 id="titre">AJOUTER UN SCORE</h2>
    <div class="flex">
        <div id="input">
            <label >Nom :</label><br>
            <input type="text" id="nom" placeholder="Votre nom"><br>
            <label>Score :</label><br>
            <input type="number" id="score" placeholder="Votre score"><br>
            <button id="envoyer">Envoyer</button>
        </div>

        <div id="classement">
            <h2>Classement</h2>
        
            <table id="leaderboard">
                <thead>
                    <tr>
                        <th>Rang</th>
                        <th>Nom</th>
                        <th>Score</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <img src="light.gif" id="gif">
    <script>
        const envoyerBtn = document.getElementById('envoyer');
        const nomInput = document.getElementById('nom');
        const scoreInput = document.getElementById('score');
        const tbody = document.querySelector('#leaderboard tbody');

        function chargerLeaderboard() {
            fetch('get_scores.php')
                .then(response => response.json())
                .then(data => {
                    tbody.innerHTML = '';
                    data.forEach((item, index) => {
                        const tr = document.createElement('tr');
                        tr.innerHTML = `<td>${index + 1}</td><td>${item.nom_joueur}</td><td>${item.score}</td>`;
                        tbody.appendChild(tr);
                    });
                });
        }

        envoyerBtn.addEventListener('click', () => {
            const nom = nomInput.value.trim();
            const score = parseInt(scoreInput.value, 10);

            if (!nom || isNaN(score)) {
                alert('Veuillez entrer un nom et un score valides.');
                return;
            }

            fetch('save_score.php', {
                method: 'POST',
                headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                body: `nom_joueur=${encodeURIComponent(nom)}&score=${encodeURIComponent(score)}`
            })
            .then(response => response.text())
            .then(data => {
                console.log(data);
                chargerLeaderboard();
                nomInput.value = '';
                scoreInput.value = '';
            })
            .catch(err => console.error(err));
        });

        // Charger le leaderboard au d√©marrage
        chargerLeaderboard();
    </script>
</body>
</html>

